---
title: "hw-2"
author: "Youngjoo son"
output: html_document
---

```{r}
library(shiny)
library(shinythemes)
library(leaflet)
library(leaflet.extras)
library(rgdal)
```

```{r}
subway <- readOGR("SubwayEntrances.geojson")
#plot(subway)



leaflet(data = subway) %>%
  addProviderTiles("Esri.WorldTerrain") %>%
  addMarkers()
  #addPolygons(color = ~pal(`OST_PER_UOM`)) 
```

```{r}
school <- readOGR("SchoolDistricts.geojson")

leaflet(data = school) %>%
  addProviderTiles("Esri.WorldTerrain") %>%
  addPolygons()


```
```{r}
subwaylines <- readOGR("SubwayLines.geojson")

leaflet(data = subwaylines) %>%
  addProviderTiles("Esri.WorldTerrain", group = "Esri") %>%
  addProviderTiles("OpenTopoMap", group = "Topo") %>%
  addProviderTiles("Stamen.Watercolor", group = "Watercolor") %>%
  addPolylines() %>%
  # Add layers control
  addLayersControl(
    baseGroups = c("Esri", "Topo", "Watercolor"),
    options = layersControlOptions(collapsed = FALSE)
  )
```

```{r}
cons <- read.csv("Projects_in_Construction.csv")

# Define color factor
palcons <- colorFactor(c("#d73027", "#1a9850"), c("CAP", "CIP"))

leaflet(data = cons) %>%
  addProviderTiles("OpenStreetMap.DE") %>%
  addCircleMarkers(lng = ~Longitude, lat = ~Latitude, radius = 1.5, color = ~palcons(Project.type), clusterOptions = markerClusterOptions()) %>%
  addLegend(position = "topright" , pal = palcons, values = cons$Project.type, title = "Project type")
```

